window.germanized=window.germanized||{},window.germanized.dhl_parcel_locator=window.germanized.dhl_parcel_locator||{},function(l,p){p.dhl_parcel_locator={params:{},parcelShops:[],wrapper:"",init:function(){var a=p.dhl_parcel_locator;a.params=wc_gzd_dhl_parcel_locator_params,a.wrapper=a.params.wrapper,l(document).on("change.dhl",a.wrapper+" #shipping_address_type",a.refreshAddressType).on("change.dhl",a.wrapper+" #shipping_address_1",a.onChangeAddress).on("change.dhl",a.wrapper+" #ship-to-different-address-checkbox",a.onChangeShipping).on("change.dhl",a.wrapper+" #shipping_country",a.refreshAvailability),a.refreshAvailability(),a.refreshAddressType()},refreshAvailability:function(){var a=p.dhl_parcel_locator;a.isAvailable()?l(a.wrapper+" #shipping_address_type_field").show():(l(a.wrapper+" #shipping_address_type").val("regular").trigger("change"),l(a.wrapper+" #shipping_address_type_field").hide())},onChangeShipping:function(){var a=p.dhl_parcel_locator;l(this).is(":checked")&&(a.refreshAvailability(),a.isEnabled()&&a.refreshAddressType())},onChangeAddress:function(){var a=p.dhl_parcel_locator;a.isEnabled()&&a.formatAddress()},formatAddress:function(){var a=!1,e=p.dhl_parcel_locator,r=l(e.wrapper+" #shipping_address_1"),d=r.val();0<d.length&&(l.isNumeric(d)?a=!0:e.addressIsPackstation()||e.addressIsPostOffice()||e.addressIsParcelShop()||r.val("")),a&&e.validateAddress(d),e.refreshCustomerNumberStatus()},addressIsPackstation:function(){var a=p.dhl_parcel_locator;return 0<=l(a.wrapper+" #shipping_address_1").val().toLowerCase().indexOf(a.params.i18n.packstation.toLowerCase())},addressIsPostOffice:function(){var a=p.dhl_parcel_locator;return 0<=l(a.wrapper+" #shipping_address_1").val().toLowerCase().indexOf(a.params.i18n.postoffice.toLowerCase())},addressIsParcelShop:function(){var a=p.dhl_parcel_locator;return 0<=l(a.wrapper+" #shipping_address_1").val().toLowerCase().indexOf(a.params.i18n.parcelshop.toLowerCase())},customerNumberIsMandatory:function(){var a=p.dhl_parcel_locator;return!!a.isEnabled()&&(!!a.addressIsPackstation()||(a.addressIsParcelShop()||a.addressIsPostOffice(),!1))},refreshCustomerNumberStatus:function(){var a=p.dhl_parcel_locator,e=l(a.wrapper+" #shipping_dhl_postnumber_field");a.customerNumberIsMandatory()?(e.find("label span").length&&e.find("label span").hasClass("required")||e.find("label").append(' <span class="required">*</span>'),e.find("label span.optional").hide(),e.addClass("validate-required")):(e.find("label span.required").remove(),e.find("label span.optional").show(),e.removeClass("validate-required woocommerce-invalid woocommerce-invalid-required-field"))},validateAddress:function(a){var e=p.dhl_parcel_locator,r={action:"woocommerce_gzd_dhl_parcel_locator_validate_address",address:a,security:e.params.parcel_locator_nonce};l.ajax({type:"POST",url:e.params.ajax_url,data:r,success:function(a){a.valid?(l(e.wrapper+" #shipping_address_1").val(a.address),e.refreshCustomerNumberStatus()):l(e.wrapper+" #shipping_address_1").val("")},error:function(a){},dataType:"json"})},refreshAddressType:function(){var a,e=p.dhl_parcel_locator,r=l(e.wrapper+" #shipping_address_1_field"),d=l(e.wrapper+" #shipping_address_1"),s=d.val();e.isEnabled()?(l(e.wrapper+" #shipping_dhl_postnumber_field").show(),d.data("label-dhl")&&(a=r.find("label span, label abbr"),r.find("label").html(d.data("label-dhl")+" "),r.find("label").append(a)),d.data("placeholder-dhl")&&d.attr("placeholder",d.data("placeholder-dhl")),d.data("desc-dhl")&&0===r.find(".dhl-desc").length&&r.find(".woocommerce-input-wrapper").after('<p class="desc dhl-desc">'+d.data("desc-dhl")+"</p>"),0<s.length&&e.formatAddress()):(l(e.wrapper+" #shipping_dhl_postnumber_field").hide(),d.data("label-regular")&&(a=r.find("label span, label abbr"),r.find("label").html(d.data("label-regular")+" "),r.find("label").append(a)),d.data("placeholder-regular")&&d.attr("placeholder",d.data("placeholder-regular")),r.find(".dhl-desc").remove())},isEnabled:function(){var a=p.dhl_parcel_locator;return a.isAvailable()&&"dhl"===l(a.wrapper+" #shipping_address_type").val()},isAvailable:function(){var a=p.dhl_parcel_locator,e=l(a.wrapper+" #shipping_country").val();return-1!==l.inArray(e,a.params.supported_countries)}},l(document).ready(function(){p.dhl_parcel_locator.init()})}(jQuery,window.germanized);